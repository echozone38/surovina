
<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Surovina v porcích</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:#0b1020;color:#e5e7eb;margin:0;padding:2rem;}
    h1,h2,h3{color:#e5e7eb;margin:0 0 .75rem}
    .card{background:#111827;border:1px solid #1f2937;border-radius:.75rem;padding:1rem;margin-bottom:1rem}
    label{display:block;margin:.25rem 0 .25rem;color:#93c5fd}
    input[type="number"]{width:100%;padding:.5rem;border-radius:.5rem;border:1px solid #374151;background:#0f172a;color:#e5e7eb}
    table{width:100%;border-collapse:collapse;margin-top:.5rem}
    th,td{border:1px solid #1f2937;padding:.5rem;text-align:left}
    th{background:#0f172a;color:#93c5fd}
    .btns{display:flex;gap:.5rem;margin-top:.5rem}
    button{background:#0f766e;color:white;border:none;border-radius:.5rem;padding:.5rem .75rem;cursor:pointer}
    button.secondary{background:#374151}
  </style>
</head>
<body>
  <h1>Surovina v porcích</h1>

  <div class="card">
    <h2>Vstupy</h2>
    <label for="F1">Surovina</label>
    <input id="F1" type="number" min="0" step="0.1" />
    <label for="SUMA" style="margin-top:.75rem">Celková váha</label>
    <input id="SUMA" type="number" readonly />
    <div class="btns">
      <button id="resetBtn" class="secondary">Reset</button>
    </div>
  </div>

  <div class="card">
    <h3>Porce a podíly</h3>
    <table>
      <thead>
        <tr>
          <th>Osoba</th>
          <th>Porce</th>
          <th>Podíly</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Kája</td>
          <td><input id="F3" type="number" readonly /></td>
          <td><input id="F5" type="number" min="0" step="0.1" value="100" /></td>
        </tr>
        <tr>
          <td>Máša</td>
          <td><input id="G3" type="number" readonly /></td>
          <td><input id="G5" type="number" min="0" step="0.1" value="80" /></td>
        </tr>
        <tr>
          <td>Fanda</td>
          <td><input id="H3" type="number" readonly /></td>
          <td><input id="H5" type="number" min="0" step="0.1" value="45" /></td>
        </tr>
        <tr>
          <td>Tóňa</td>
          <td><input id="I3" type="number" readonly /></td>
          <td><input id="I5" type="number" min="0" step="0.1" value="35" /></td>
        </tr>
      </tbody>
    </table>
  </div>

<script>
(function(){
  const ids = ['F1','F3','G3','H3','I3','F5','G5','H5','I5','SUMA'];
  const el = Object.fromEntries(ids.map(id=>[id, document.getElementById(id)]));

  function recalc(){
    const F1 = parseFloat(el.F1.value)||0;
    const F5 = parseFloat(el.F5.value)||0;
    const G5 = parseFloat(el.G5.value)||0;
    const H5 = parseFloat(el.H5.value)||0;
    const I5 = parseFloat(el.I5.value)||0;

    if(G5>0){
      el.F3.value = +(F1 * F5 / G5).toFixed(2);
      el.G3.value = +(F1 * G5 / G5).toFixed(2);
      el.H3.value = +(F1 * H5 / G5).toFixed(2);
      el.I3.value = +(F1 * I5 / G5).toFixed(2);
    }else{
      el.F3.value = el.G3.value = el.H3.value = el.I3.value = '';
    }
    const suma = ['F3','G3','H3','I3'].reduce((s,k)=>s+(parseFloat(el[k].value)||0),0);
    el.SUMA.value = G5>0 ? +suma.toFixed(2) : '';
    localStorage.setItem('porce_state', JSON.stringify({F1,F5,G5,H5,I5}));
  }

  function restore(){
    try{
      const s = JSON.parse(localStorage.getItem('porce_state')||'{}');
      if(Object.keys(s).length){
        ['F1','F5','G5','H5','I5'].forEach(k=>{ if(s[k]!==undefined) el[k].value = s[k]; });
      }
      // if no saved state, defaults are already in HTML values (100,80,45,35)
      recalc();
    }catch(e){ recalc(); }
  }

  ['F1','F5','G5','H5','I5'].forEach(k=> el[k].addEventListener('input', recalc));
  document.getElementById('resetBtn').addEventListener('click', ()=>{
    ['F1'].forEach(k=> el[k].value='');
    // restore editable defaults for shares
    el.F5.value = 100; el.G5.value = 80; el.H5.value = 45; el.I5.value = 35;
    ['F3','G3','H3','I3','SUMA'].forEach(k=> el[k].value='');
    localStorage.removeItem('porce_state');
  });

  if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
  restore();
})();
</script>
</body>
</html>
